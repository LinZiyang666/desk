[rank0]: Traceback (most recent call last):
[rank0]:   File "/local/desk/qwen2.5_omni_3b_devide_head.py", line 951, in <module>
[rank0]:     main()
[rank0]:   File "/local/desk/qwen2.5_omni_3b_devide_head.py", line 777, in main
[rank0]:     sched.step(audio_inputs=aud_pack, target=tgt)
[rank0]:   File "/local/desk/pipelining_source_code/schedules.py", line 1358, in step
[rank0]:     args_split, kwargs_split = self._split_inputs(args, kwargs)
[rank0]:                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/local/desk/pipelining_source_code/schedules.py", line 458, in _split_inputs
[rank0]:     args_split, kwargs_split = split_args_kwargs_into_chunks(
[rank0]:                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/local/desk/pipelining_source_code/microbatch.py", line 353, in split_args_kwargs_into_chunks
[rank0]:     _postfix_slice_listlike_by_samples(kwargs, kwargs_split)
[rank0]:   File "/local/desk/pipelining_source_code/microbatch.py", line 550, in _postfix_slice_listlike_by_samples
[rank0]:     mb_sizes = _infer_mb_sizes_from_kwargs_split(kwargs_split)
[rank0]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/local/desk/pipelining_source_code/microbatch.py", line 539, in _infer_mb_sizes_from_kwargs_split
[rank0]:     raise RuntimeError(f"Cannot infer microbatch size for kwargs_split[{i}]")
[rank0]: RuntimeError: Cannot infer microbatch size for kwargs_split[0]

[rank1]: Traceback (most recent call last):
[rank1]:   File "/local/desk/qwen2.5_omni_3b_devide_head.py", line 951, in <module>
[rank1]:     main()
[rank1]:   File "/local/desk/qwen2.5_omni_3b_devide_head.py", line 800, in main
[rank1]:     sched.step(vision_inputs=vis_pack, target=tgt)
[rank1]:   File "/local/desk/pipelining_source_code/schedules.py", line 1358, in step
[rank1]:     args_split, kwargs_split = self._split_inputs(args, kwargs)
[rank1]:                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/local/desk/pipelining_source_code/schedules.py", line 458, in _split_inputs
[rank1]:     args_split, kwargs_split = split_args_kwargs_into_chunks(
[rank1]:                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/local/desk/pipelining_source_code/microbatch.py", line 353, in split_args_kwargs_into_chunks
[rank1]:     _postfix_slice_listlike_by_samples(kwargs, kwargs_split)
[rank1]:   File "/local/desk/pipelining_source_code/microbatch.py", line 550, in _postfix_slice_listlike_by_samples
[rank1]:     mb_sizes = _infer_mb_sizes_from_kwargs_split(kwargs_split)
[rank1]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/local/desk/pipelining_source_code/microbatch.py", line 539, in _infer_mb_sizes_from_kwargs_split
[rank1]:     raise RuntimeError(f"Cannot infer microbatch size for kwargs_split[{i}]")
[rank1]: RuntimeError: Cannot infer microbatch size for kwargs_split[0]

[rank2]: Traceback (most recent call last):
[rank2]:   File "/local/desk/qwen2.5_omni_3b_devide_head.py", line 951, in <module>
[rank2]:     main()
[rank2]:   File "/local/desk/qwen2.5_omni_3b_devide_head.py", line 803, in main
[rank2]:     sched.step(input_ids=inp_ids, attention_mask=attn, target=tgt)
[rank2]:   File "/local/desk/pipelining_source_code/schedules.py", line 1366, in step
[rank2]:     self._step_microbatches(args_split, kwargs_split, targets_split, losses)
[rank2]:   File "/local/desk/schedule_runtime.py", line 926, in _step_microbatches
[rank2]:     self._initialize_stages(arg_mbs[0], kwarg_mbs[0])
[rank2]:   File "/local/desk/pipelining_source_code/schedules.py", line 1289, in _initialize_stages
[rank2]:     next_stage_args = stage._prepare_forward_infra(
[rank2]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/local/desk/pipelining_source_code/stage.py", line 1463, in _prepare_forward_infra
[rank2]:     outputs = self._shape_inference(args, kwargs)
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/local/desk/stage_with_mutiple_ranks.py", line 1190, in _shape_inference
[rank2]:     return super()._shape_inference(self, args, kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]: TypeError: PipelineStage_with_mutiple_ranks._shape_inference() takes from 2 to 3 positional arguments but 4 were given

其他的rank都因为上面三个rank出错而被挂掉